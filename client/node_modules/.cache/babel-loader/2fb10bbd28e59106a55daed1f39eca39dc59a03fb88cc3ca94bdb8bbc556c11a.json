{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Auth = void 0;\nconst uuid_1 = require(\"uuid\");\nconst crypto_js_1 = __importDefault(require(\"crypto-js\"));\nconst events_1 = require(\"events\");\nconst types_1 = require(\"./types\");\nconst utils_1 = require(\"./utils\");\nclass Auth {\n  constructor(config) {\n    this.config = config;\n    this.userStore = \"particle_user_info\";\n    this.events = new events_1.EventEmitter();\n    this.secretKey = \"\";\n    this._authResult = null;\n    this.uiMode = \"auto\";\n    this.displayCloseButton = true;\n    this.config = config;\n    window.addEventListener(\"message\", event => {\n      if (event.data.name && event.data.name === \"particle-network-provider\" && this._authResult) {\n        const data = this.decrypt(event.data.data);\n        if (data.token && data.uuid) {\n          this.setUserInfo(data);\n        }\n        if (data.wallets) {\n          const userInfo = this.userInfo();\n          if (userInfo) {\n            userInfo.wallets = data.wallets;\n            this.setUserInfo(userInfo);\n          }\n        }\n        if (data.error) {\n          if (data.error.code === 8005 || data.error.code === 10005) {\n            this.setUserInfo(null);\n            this.events.emit(\"disconnect\");\n          }\n          this._authResult.reject(data.error);\n        } else {\n          this._authResult.resolve(data);\n        }\n        this._authResult.iframe.remove();\n        this._authResult = null;\n        const container = document.getElementById(\"particle-network-container\");\n        if (container) {\n          container.style.display = \"none\";\n        }\n      }\n    });\n  }\n  login(config) {\n    var _a;\n    const iframe = this.getIframe();\n    iframe.src = this.buildUrl(\"/login\", {\n      login_type: config === null || config === void 0 ? void 0 : config.preferredAuthType,\n      support_auth_types: (_a = config === null || config === void 0 ? void 0 : config.supportAuthTypes) !== null && _a !== void 0 ? _a : \"all\",\n      account: config === null || config === void 0 ? void 0 : config.emailOrPhoneAccount,\n      login_form_mode: config === null || config === void 0 ? void 0 : config.loginFormMode\n    });\n    return new Promise((resolve, reject) => {\n      this.setAuthResult({\n        resolve: value => {\n          this.events.emit(\"connect\", value);\n          resolve(value);\n        },\n        reject,\n        iframe\n      });\n    });\n  }\n  logout() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const iframe = this.getIframe();\n      iframe.src = this.buildUrl(\"/logout\");\n      return new Promise((resolve, reject) => {\n        this.setAuthResult({\n          resolve: () => {\n            this.setUserInfo(null);\n            this.events.emit(\"disconnect\");\n            resolve();\n          },\n          reject,\n          iframe\n        });\n      });\n    });\n  }\n  sign(method, message) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this.walletExist()) {\n        return Promise.reject(types_1.AuthError.walletNotCreated());\n      }\n      const iframe = this.getIframe();\n      if (this.config.chainName === \"solana\") {\n        iframe.src = this.buildUrl(\"/solana/sign\", {\n          token: (_a = this.userInfo()) === null || _a === void 0 ? void 0 : _a.token,\n          method: method,\n          chain_id: Number(this.config.chainId),\n          message: message\n        });\n      } else {\n        iframe.src = this.buildUrl(\"/evm-chain/sign\", {\n          token: (_b = this.userInfo()) === null || _b === void 0 ? void 0 : _b.token,\n          method: method,\n          chain_id: Number(this.config.chainId),\n          message: message\n        });\n      }\n      return new Promise((resolve, reject) => {\n        this.setAuthResult({\n          resolve: value => {\n            var _a;\n            resolve((_a = value.signature) !== null && _a !== void 0 ? _a : \"\");\n          },\n          reject,\n          iframe\n        });\n      });\n    });\n  }\n  signAllTransactions(messages) {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this.walletExist()) {\n        return Promise.reject(types_1.AuthError.walletNotCreated());\n      }\n      if (this.config.chainName !== \"solana\") {\n        return Promise.reject(types_1.AuthError.unsupportedMethod());\n      }\n      const result = yield this.sign(\"signAllTransactions\", JSON.stringify(messages));\n      const signatures = JSON.parse(result);\n      return signatures;\n    });\n  }\n  sendTransaction(message) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n      if (!this.walletExist()) {\n        return Promise.reject(types_1.AuthError.walletNotCreated());\n      }\n      if (this.config.chainName === \"solana\") {\n        return this.sign(\"signAndSendTransaction\", message);\n      } else {\n        const iframe = this.getIframe();\n        iframe.src = this.buildUrl(\"/evm-chain/sign\", {\n          token: (_a = this.userInfo()) === null || _a === void 0 ? void 0 : _a.token,\n          method: \"eth_sendTransaction\",\n          chain_id: Number(this.config.chainId),\n          message: message\n        });\n        return new Promise((resolve, reject) => {\n          this.setAuthResult({\n            resolve: value => {\n              var _a;\n              resolve((_a = value.signature) !== null && _a !== void 0 ? _a : \"\");\n            },\n            reject,\n            iframe\n          });\n        });\n      }\n    });\n  }\n  setChainInfo(chain) {\n    const userInfo = this.userInfo();\n    if (!userInfo) {\n      return Promise.reject(types_1.AuthError.notLogin());\n    }\n    if (typeof chain.name !== \"string\" || typeof chain.id !== \"number\") {\n      throw types_1.AuthError.paramsError();\n    }\n    if (!Object.keys(types_1.supportChains).includes(chain.name)) {\n      throw types_1.AuthError.unsupportedChain();\n    }\n    const chainName = chain.name;\n    if (!types_1.supportChains[chainName].includes(chain.id)) {\n      throw types_1.AuthError.unsupportedChain();\n    }\n    const wallets = userInfo.wallets;\n    if (this.config.chainName === chain.name && this.config.chainId === chain.id) {\n      return Promise.resolve(wallets);\n    }\n    const wallet = this.wallet(chainName === \"solana\" ? \"solana\" : \"evm_chain\");\n    if (wallet) {\n      this.config.chainName = chain.name;\n      this.config.chainId = chain.id;\n      this.events.emit(\"chainChanged\", chain);\n      return Promise.resolve(wallets);\n    }\n    //create wallet\n    const iframe = this.getIframe();\n    iframe.src = this.buildUrl(\"/wallet\", {\n      token: userInfo.token,\n      chain_name: chain.name\n    });\n    return new Promise((resolve, reject) => {\n      this.setAuthResult({\n        resolve: value => {\n          this.config.chainName = chain.name;\n          this.config.chainId = chain.id;\n          this.events.emit(\"connect\", this.userInfo());\n          this.events.emit(\"chainChanged\", chain);\n          resolve(value);\n        },\n        reject,\n        iframe\n      });\n    });\n  }\n  chainId() {\n    return this.config.chainId;\n  }\n  basicCredentials() {\n    return `Basic ${Buffer.from(`${this.config.projectId}:${this.config.clientKey}`, \"utf8\").toString(\"base64\")}`;\n  }\n  isLogin() {\n    return this.userInfo() !== null;\n  }\n  userInfo() {\n    const info = window.localStorage.getItem(this.userStore);\n    return info ? JSON.parse(info) : null;\n  }\n  walletExist() {\n    return this.wallet() != null;\n  }\n  wallet(chainType) {\n    const userInfo = this.userInfo();\n    if (!userInfo) {\n      return null;\n    }\n    const wallet = userInfo.wallets.find(wallet => wallet.chain_name === (chainType || this.walletChainName()));\n    if (wallet !== undefined && wallet.public_address.length > 0) {\n      return wallet;\n    }\n    return null;\n  }\n  setAuthTheme(config) {\n    if (config.uiMode) {\n      this.uiMode = config.uiMode;\n    }\n    if (config.displayCloseButton !== null && config.displayCloseButton !== undefined) {\n      this.displayCloseButton = config.displayCloseButton;\n    }\n  }\n  on(event, listener) {\n    this.events.on(event, listener);\n  }\n  once(event, listener) {\n    this.events.once(event, listener);\n  }\n  off(event, listener) {\n    this.events.off(event, listener);\n  }\n  removeListener(event, listener) {\n    this.events.removeListener(event, listener);\n  }\n  walletChainName() {\n    return this.config.chainName === \"solana\" ? \"solana\" : \"evm_chain\";\n  }\n  setAuthResult(authResult) {\n    if (this._authResult) {\n      this._authResult.reject(types_1.AuthError.userCancelOperation());\n    }\n    this._authResult = authResult;\n  }\n  setUserInfo(info) {\n    if (info) {\n      window.localStorage.setItem(this.userStore, JSON.stringify(info));\n    } else {\n      window.localStorage.removeItem(this.userStore);\n    }\n  }\n  getIframe() {\n    let containerDiv = document.getElementById(\"particle-network-container\");\n    if (!containerDiv) {\n      containerDiv = document.createElement(\"div\");\n      containerDiv.setAttribute(\"style\", \"display: block;position: fixed;top: 0px;right: 0px;width: 100%;height: 100%;border-radius: 0px;border: none;z-index: 2147483647;background-color: rgba(0, 0, 0, 0.5);align-items: center;\");\n      containerDiv.id = \"particle-network-container\";\n      document.body.appendChild(containerDiv);\n    } else {\n      containerDiv.style.display = \"block\";\n    }\n    let iframe;\n    const elements = document.getElementsByName(\"particle-network-iframe\");\n    if (elements.length > 0) {\n      iframe = elements[0];\n      iframe.style.display = \"\";\n    } else {\n      iframe = document.createElement(\"iframe\");\n      iframe.name = \"particle-network-iframe\";\n      let bgColor = \"background-color: #FFFFFF\";\n      const themeType = this.getThemeType();\n      if (themeType === \"dark\") {\n        bgColor = \"background-color: #000000\";\n      }\n      iframe.setAttribute(\"style\", \"position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);width: 400px;height: 650px;border-radius: 0px;border: none;z-index: 2147483647;box-shadow: -1px 3px 11px 2px #00000073;border-radius: 10px;\" + bgColor);\n      containerDiv.appendChild(iframe);\n    }\n    return iframe;\n  }\n  buildUrl(path) {\n    let extraParams = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var _a;\n    const schema = (_a = this.config.authUrl) !== null && _a !== void 0 ? _a : \"https://auth.particle.network\";\n    const params = {\n      project_uuid: this.config.projectId,\n      project_client_key: this.config.clientKey,\n      project_app_uuid: this.config.appId,\n      chain_name: this.config.chainName,\n      sdk_version: (0, utils_1.getVersion)(),\n      device_id: (0, utils_1.getDeviceId)(),\n      display_close_button: this.displayCloseButton\n    };\n    Object.assign(params, Object.assign({}, extraParams));\n    this.secretKey = (0, uuid_1.v4)().replace(/-/g, \"\").toUpperCase();\n    const keyWA = crypto_js_1.default.enc.Utf8.parse(this.secretKey);\n    const cipherText = crypto_js_1.default.AES.encrypt(JSON.stringify(params), keyWA, {\n      mode: crypto_js_1.default.mode.ECB,\n      algorithm: crypto_js_1.default.algo.AES,\n      padding: crypto_js_1.default.pad.Pkcs7,\n      formatter: crypto_js_1.default.format.Hex\n    }).ciphertext;\n    const value = encodeURIComponent(crypto_js_1.default.enc.Base64.stringify(cipherText)) + this.secretKey;\n    const url = `${schema}?params=${value}&encoding=base64&theme_type=${this.getThemeType()}#${path}`;\n    return url;\n  }\n  getThemeType() {\n    return this.uiMode === \"auto\" ? window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\" : this.uiMode;\n  }\n  decrypt(data) {\n    const dec = crypto_js_1.default.enc.Hex.parse(data);\n    const keyWA = crypto_js_1.default.enc.Utf8.parse(this.secretKey);\n    const bytes = crypto_js_1.default.AES.decrypt(crypto_js_1.default.lib.CipherParams.create({\n      ciphertext: dec,\n      key: keyWA,\n      algorithm: crypto_js_1.default.algo.AES,\n      padding: crypto_js_1.default.pad.Pkcs7,\n      formatter: crypto_js_1.default.format.Hex\n    }), keyWA, {\n      mode: crypto_js_1.default.mode.ECB\n    });\n    return JSON.parse(bytes.toString(crypto_js_1.default.enc.Utf8));\n  }\n}\nexports.Auth = Auth;","map":{"version":3,"mappings":"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","names":["Auth","constructor","config","events_1","window","addEventListener","event","data","name","_authResult","decrypt","token","uuid","setUserInfo","wallets","userInfo","error","code","events","emit","reject","resolve","iframe","remove","container","document","getElementById","style","display","login","getIframe","src","buildUrl","login_type","preferredAuthType","support_auth_types","supportAuthTypes","account","emailOrPhoneAccount","login_form_mode","loginFormMode","Promise","setAuthResult","value","logout","sign","method","message","walletExist","types_1","walletNotCreated","chainName","chain_id","Number","chainId","signature","signAllTransactions","messages","unsupportedMethod","result","JSON","stringify","signatures","parse","sendTransaction","setChainInfo","chain","notLogin","id","paramsError","Object","keys","includes","unsupportedChain","wallet","chain_name","basicCredentials","Buffer","from","projectId","clientKey","toString","isLogin","info","localStorage","getItem","userStore","chainType","find","walletChainName","undefined","public_address","length","setAuthTheme","uiMode","displayCloseButton","on","listener","once","off","removeListener","authResult","userCancelOperation","setItem","removeItem","containerDiv","createElement","setAttribute","body","appendChild","elements","getElementsByName","bgColor","themeType","getThemeType","path","extraParams","schema","authUrl","params","project_uuid","project_client_key","project_app_uuid","appId","sdk_version","device_id","display_close_button","assign","secretKey","replace","toUpperCase","keyWA","crypto_js_1","enc","Utf8","cipherText","AES","encrypt","mode","ECB","algorithm","algo","padding","pad","Pkcs7","formatter","format","Hex","ciphertext","encodeURIComponent","Base64","url","matchMedia","matches","dec","bytes","lib","CipherParams","create","key","exports"],"sources":["../src/auth.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}