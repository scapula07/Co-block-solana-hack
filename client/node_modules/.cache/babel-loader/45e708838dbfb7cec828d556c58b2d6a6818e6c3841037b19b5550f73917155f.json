{"ast":null,"code":"var _s = $RefreshSig$();\nimport * as anchor from '@project-serum/anchor';\nimport { useEffect, useMemo, useState } from 'react';\nimport { PublicKey } from \"@solana/web3.js\";\nimport coBlockIdl from \"../IDL/coblock.json\";\nimport { SystemProgram } from '@solana/web3.js';\nimport { utf8 } from '@project-serum/anchor/dist/cjs/utils/bytes';\nimport { findProgramAddressSync } from '@project-serum/anchor/dist/cjs/utils/pubkey';\nimport { useAnchorWallet, useConnection, useWallet } from '@solana/wallet-adapter-react';\nimport { devFilter } from '../utils';\nconst COBLOCK_PROGRAM_PUBKEY = new PublicKey(\"CJK7mK6KtpuZYvtnJiG48Ek6CwM7WNNuYza268nDXn54\");\nexport function useActions() {\n  _s();\n  const {\n    connection\n  } = useConnection();\n  const {\n    publicKey\n  } = useWallet();\n  const anchorWallet = useAnchorWallet();\n  const [lastTask, setLastTask] = useState(0);\n  const program = useMemo(() => {\n    if (anchorWallet) {\n      const provider = new anchor.AnchorProvider(connection, anchorWallet, anchor.AnchorProvider.defaultOptions());\n      return new anchor.Program(coBlockIdl, COBLOCK_PROGRAM_PUBKEY, provider);\n    }\n  }, [connection, anchorWallet]);\n  useEffect(() => {\n    const findDevAccounts = async () => {\n      try {\n        const [devPda, devBump] = await findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId);\n        const devAccount = await program.account.staffProfile.fetch(devPda);\n        console.log(devAccount);\n        if (devAccount) {\n          setLastTask(devAccount.lastTask);\n          const taskAccounts = await program.account.todoAccount.all([devFilter(publicKey.toString())]);\n          console.log(taskAccounts, \"taskAccounts\");\n        } else {}\n      } catch (e) {\n        console.log(e);\n      }\n    };\n    findDevAccounts();\n  }, [publicKey, program]);\n  const initializeUser = async () => {\n    try {\n      const [devPda, devBump] = findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId);\n      console.log(devPda, \"devpds\");\n      console.log(publicKey, \"publick\");\n      const tx = await program.methods.initializeStaff().accounts({\n        staffProfile: devPda,\n        authority: publicKey,\n        systemProgram: SystemProgram.programId\n      }).rpc();\n      console.log(tx, \"txxxxxx\");\n    } catch (e) {\n      console.log(e);\n    }\n  };\n  const addTask = async () => {\n    try {\n      const [devPda, devBump] = findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId);\n      const [taskPda, taskBump] = findProgramAddressSync([utf8.encode('TASk_STATE'), publicKey.toBuffer(), Uint8Array.from([lastTask])], program.programId);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n  return {\n    initializeUser\n  };\n}\n_s(useActions, \"ve9q/ewsFMz+b8Tp6bqWxHfZNS0=\", false, function () {\n  return [useConnection, useWallet, useAnchorWallet];\n});","map":{"version":3,"names":["anchor","useEffect","useMemo","useState","PublicKey","coBlockIdl","SystemProgram","utf8","findProgramAddressSync","useAnchorWallet","useConnection","useWallet","devFilter","COBLOCK_PROGRAM_PUBKEY","useActions","connection","publicKey","anchorWallet","lastTask","setLastTask","program","provider","AnchorProvider","defaultOptions","Program","findDevAccounts","devPda","devBump","encode","toBuffer","programId","devAccount","account","staffProfile","fetch","console","log","taskAccounts","todoAccount","all","toString","e","initializeUser","tx","methods","initializeStaff","accounts","authority","systemProgram","rpc","addTask","taskPda","taskBump","Uint8Array","from"],"sources":["/Users/user/Desktop/solana-hack-1/solana-payroll/src/Hooks/coblocks.utils.js"],"sourcesContent":["import * as anchor from '@project-serum/anchor'\nimport { useEffect, useMemo, useState } from 'react'\nimport { PublicKey } from \"@solana/web3.js\";\nimport coBlockIdl from \"../IDL/coblock.json\"\nimport { SystemProgram } from '@solana/web3.js'\nimport { utf8 } from '@project-serum/anchor/dist/cjs/utils/bytes'\nimport { findProgramAddressSync } from '@project-serum/anchor/dist/cjs/utils/pubkey'\nimport { useAnchorWallet, useConnection, useWallet } from '@solana/wallet-adapter-react'\nimport { devFilter } from '../utils';\n\nconst COBLOCK_PROGRAM_PUBKEY = new PublicKey(\"CJK7mK6KtpuZYvtnJiG48Ek6CwM7WNNuYza268nDXn54\");\n\nexport function useActions() {\n    \n\n    const { connection } = useConnection()\n    const { publicKey } = useWallet()\n    const anchorWallet = useAnchorWallet()\n  \n    const [lastTask, setLastTask] = useState(0)\n\n    const program = useMemo(() => {\n        if (anchorWallet) {\n            const provider = new anchor.AnchorProvider(connection, anchorWallet, anchor.AnchorProvider.defaultOptions())\n            return new anchor.Program(coBlockIdl, COBLOCK_PROGRAM_PUBKEY, provider)\n        }\n    }, [connection, anchorWallet])\n\n\n\n\n    useEffect(() => {\n\n        const findDevAccounts = async () => {\n            try {\n                const [devPda, devBump] =await findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId)\n                const devAccount = await program.account.staffProfile.fetch(devPda)\n\n                console.log(devAccount)\n\n                if (devAccount) {\n                    setLastTask(devAccount.lastTask)\n                       \n\n                    const taskAccounts = await program.account.todoAccount.all([devFilter(publicKey.toString())])\n                    console.log(taskAccounts,\"taskAccounts\")\n                }else{\n\n                }\n\n            }catch(e){\n                console.log(e)\n            }\n        }\n        findDevAccounts()\n    },[publicKey, program])\n\n\n    const initializeUser = async () => {\n        \n        try{\n            const [devPda, devBump] = findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId)\n            console.log(devPda,\"devpds\")\n            console.log(publicKey,\"publick\")\n            const tx = await program.methods\n            .initializeStaff()\n            .accounts({\n                staffProfile: devPda,\n                authority: publicKey,\n                systemProgram: SystemProgram.programId,\n            })\n            .rpc()\n\n            console.log(tx,\"txxxxxx\")\n        }catch(e){\n            console.log(e)\n        }\n\n    }\n\n    const addTask = async () => {\n        try {\n                const [devPda,devBump] = findProgramAddressSync([utf8.encode('STAFF_STATE'), publicKey.toBuffer()], program.programId)\n                const [taskPda, taskBump] = findProgramAddressSync([utf8.encode('TASk_STATE'), publicKey.toBuffer(), Uint8Array.from([lastTask])], program.programId)\n\n        }catch(e){\n            console.log(e)\n        }\n        \n    }\n\n    return {  initializeUser }\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}