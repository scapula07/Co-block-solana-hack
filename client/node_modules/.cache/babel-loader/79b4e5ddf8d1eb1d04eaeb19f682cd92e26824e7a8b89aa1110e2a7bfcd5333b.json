{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataProducer = void 0;\nconst Logger_1 = require(\"./Logger\");\nconst EnhancedEventEmitter_1 = require(\"./EnhancedEventEmitter\");\nconst errors_1 = require(\"./errors\");\nconst logger = new Logger_1.Logger('DataProducer');\nclass DataProducer extends EnhancedEventEmitter_1.EnhancedEventEmitter {\n  constructor(_ref) {\n    let {\n      id,\n      dataChannel,\n      sctpStreamParameters,\n      appData\n    } = _ref;\n    super();\n    // Closed flag.\n    this._closed = false;\n    // Observer instance.\n    this._observer = new EnhancedEventEmitter_1.EnhancedEventEmitter();\n    logger.debug('constructor()');\n    this._id = id;\n    this._dataChannel = dataChannel;\n    this._sctpStreamParameters = sctpStreamParameters;\n    this._appData = appData || {};\n    this.handleDataChannel();\n  }\n  /**\n   * DataProducer id.\n   */\n  get id() {\n    return this._id;\n  }\n  /**\n   * Whether the DataProducer is closed.\n   */\n  get closed() {\n    return this._closed;\n  }\n  /**\n   * SCTP stream parameters.\n   */\n  get sctpStreamParameters() {\n    return this._sctpStreamParameters;\n  }\n  /**\n   * DataChannel readyState.\n   */\n  get readyState() {\n    return this._dataChannel.readyState;\n  }\n  /**\n   * DataChannel label.\n   */\n  get label() {\n    return this._dataChannel.label;\n  }\n  /**\n   * DataChannel protocol.\n   */\n  get protocol() {\n    return this._dataChannel.protocol;\n  }\n  /**\n   * DataChannel bufferedAmount.\n   */\n  get bufferedAmount() {\n    return this._dataChannel.bufferedAmount;\n  }\n  /**\n   * DataChannel bufferedAmountLowThreshold.\n   */\n  get bufferedAmountLowThreshold() {\n    return this._dataChannel.bufferedAmountLowThreshold;\n  }\n  /**\n   * Set DataChannel bufferedAmountLowThreshold.\n   */\n  set bufferedAmountLowThreshold(bufferedAmountLowThreshold) {\n    this._dataChannel.bufferedAmountLowThreshold = bufferedAmountLowThreshold;\n  }\n  /**\n   * App custom data.\n   */\n  get appData() {\n    return this._appData;\n  }\n  /**\n   * Invalid setter.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  set appData(appData) {\n    throw new Error('cannot override appData object');\n  }\n  get observer() {\n    return this._observer;\n  }\n  /**\n   * Closes the DataProducer.\n   */\n  close() {\n    if (this._closed) return;\n    logger.debug('close()');\n    this._closed = true;\n    this._dataChannel.close();\n    this.emit('@close');\n    // Emit observer event.\n    this._observer.safeEmit('close');\n  }\n  /**\n   * Transport was closed.\n   */\n  transportClosed() {\n    if (this._closed) return;\n    logger.debug('transportClosed()');\n    this._closed = true;\n    this._dataChannel.close();\n    this.safeEmit('transportclose');\n    // Emit observer event.\n    this._observer.safeEmit('close');\n  }\n  /**\n   * Send a message.\n   *\n   * @param {String|Blob|ArrayBuffer|ArrayBufferView} data.\n   */\n  send(data) {\n    logger.debug('send()');\n    if (this._closed) throw new errors_1.InvalidStateError('closed');\n    this._dataChannel.send(data);\n  }\n  handleDataChannel() {\n    this._dataChannel.addEventListener('open', () => {\n      if (this._closed) return;\n      logger.debug('DataChannel \"open\" event');\n      this.safeEmit('open');\n    });\n    this._dataChannel.addEventListener('error', event => {\n      if (this._closed) return;\n      let {\n        error\n      } = event;\n      if (!error) error = new Error('unknown DataChannel error');\n      if (error.errorDetail === 'sctp-failure') {\n        logger.error('DataChannel SCTP error [sctpCauseCode:%s]: %s', error.sctpCauseCode, error.message);\n      } else {\n        logger.error('DataChannel \"error\" event: %o', error);\n      }\n      this.safeEmit('error', error);\n    });\n    this._dataChannel.addEventListener('close', () => {\n      if (this._closed) return;\n      logger.warn('DataChannel \"close\" event');\n      this._closed = true;\n      this.emit('@close');\n      this.safeEmit('close');\n      // Emit observer event.\n      this._observer.safeEmit('close');\n    });\n    this._dataChannel.addEventListener('message', () => {\n      if (this._closed) return;\n      logger.warn('DataChannel \"message\" event in a DataProducer, message discarded');\n    });\n    this._dataChannel.addEventListener('bufferedamountlow', () => {\n      if (this._closed) return;\n      this.safeEmit('bufferedamountlow');\n    });\n  }\n}\nexports.DataProducer = DataProducer;","map":{"version":3,"names":["Object","defineProperty","exports","value","DataProducer","Logger_1","require","EnhancedEventEmitter_1","errors_1","logger","Logger","EnhancedEventEmitter","constructor","id","dataChannel","sctpStreamParameters","appData","_closed","_observer","debug","_id","_dataChannel","_sctpStreamParameters","_appData","handleDataChannel","closed","readyState","label","protocol","bufferedAmount","bufferedAmountLowThreshold","Error","observer","close","emit","safeEmit","transportClosed","send","data","InvalidStateError","addEventListener","event","error","errorDetail","sctpCauseCode","message","warn"],"sources":["/Users/user/Desktop/solana-hack-1/client/node_modules/mediasoup-client/lib/DataProducer.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DataProducer = void 0;\nconst Logger_1 = require(\"./Logger\");\nconst EnhancedEventEmitter_1 = require(\"./EnhancedEventEmitter\");\nconst errors_1 = require(\"./errors\");\nconst logger = new Logger_1.Logger('DataProducer');\nclass DataProducer extends EnhancedEventEmitter_1.EnhancedEventEmitter {\n    constructor({ id, dataChannel, sctpStreamParameters, appData }) {\n        super();\n        // Closed flag.\n        this._closed = false;\n        // Observer instance.\n        this._observer = new EnhancedEventEmitter_1.EnhancedEventEmitter();\n        logger.debug('constructor()');\n        this._id = id;\n        this._dataChannel = dataChannel;\n        this._sctpStreamParameters = sctpStreamParameters;\n        this._appData = appData || {};\n        this.handleDataChannel();\n    }\n    /**\n     * DataProducer id.\n     */\n    get id() {\n        return this._id;\n    }\n    /**\n     * Whether the DataProducer is closed.\n     */\n    get closed() {\n        return this._closed;\n    }\n    /**\n     * SCTP stream parameters.\n     */\n    get sctpStreamParameters() {\n        return this._sctpStreamParameters;\n    }\n    /**\n     * DataChannel readyState.\n     */\n    get readyState() {\n        return this._dataChannel.readyState;\n    }\n    /**\n     * DataChannel label.\n     */\n    get label() {\n        return this._dataChannel.label;\n    }\n    /**\n     * DataChannel protocol.\n     */\n    get protocol() {\n        return this._dataChannel.protocol;\n    }\n    /**\n     * DataChannel bufferedAmount.\n     */\n    get bufferedAmount() {\n        return this._dataChannel.bufferedAmount;\n    }\n    /**\n     * DataChannel bufferedAmountLowThreshold.\n     */\n    get bufferedAmountLowThreshold() {\n        return this._dataChannel.bufferedAmountLowThreshold;\n    }\n    /**\n     * Set DataChannel bufferedAmountLowThreshold.\n     */\n    set bufferedAmountLowThreshold(bufferedAmountLowThreshold) {\n        this._dataChannel.bufferedAmountLowThreshold = bufferedAmountLowThreshold;\n    }\n    /**\n     * App custom data.\n     */\n    get appData() {\n        return this._appData;\n    }\n    /**\n     * Invalid setter.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    set appData(appData) {\n        throw new Error('cannot override appData object');\n    }\n    get observer() {\n        return this._observer;\n    }\n    /**\n     * Closes the DataProducer.\n     */\n    close() {\n        if (this._closed)\n            return;\n        logger.debug('close()');\n        this._closed = true;\n        this._dataChannel.close();\n        this.emit('@close');\n        // Emit observer event.\n        this._observer.safeEmit('close');\n    }\n    /**\n     * Transport was closed.\n     */\n    transportClosed() {\n        if (this._closed)\n            return;\n        logger.debug('transportClosed()');\n        this._closed = true;\n        this._dataChannel.close();\n        this.safeEmit('transportclose');\n        // Emit observer event.\n        this._observer.safeEmit('close');\n    }\n    /**\n     * Send a message.\n     *\n     * @param {String|Blob|ArrayBuffer|ArrayBufferView} data.\n     */\n    send(data) {\n        logger.debug('send()');\n        if (this._closed)\n            throw new errors_1.InvalidStateError('closed');\n        this._dataChannel.send(data);\n    }\n    handleDataChannel() {\n        this._dataChannel.addEventListener('open', () => {\n            if (this._closed)\n                return;\n            logger.debug('DataChannel \"open\" event');\n            this.safeEmit('open');\n        });\n        this._dataChannel.addEventListener('error', (event) => {\n            if (this._closed)\n                return;\n            let { error } = event;\n            if (!error)\n                error = new Error('unknown DataChannel error');\n            if (error.errorDetail === 'sctp-failure') {\n                logger.error('DataChannel SCTP error [sctpCauseCode:%s]: %s', error.sctpCauseCode, error.message);\n            }\n            else {\n                logger.error('DataChannel \"error\" event: %o', error);\n            }\n            this.safeEmit('error', error);\n        });\n        this._dataChannel.addEventListener('close', () => {\n            if (this._closed)\n                return;\n            logger.warn('DataChannel \"close\" event');\n            this._closed = true;\n            this.emit('@close');\n            this.safeEmit('close');\n            // Emit observer event.\n            this._observer.safeEmit('close');\n        });\n        this._dataChannel.addEventListener('message', () => {\n            if (this._closed)\n                return;\n            logger.warn('DataChannel \"message\" event in a DataProducer, message discarded');\n        });\n        this._dataChannel.addEventListener('bufferedamountlow', () => {\n            if (this._closed)\n                return;\n            this.safeEmit('bufferedamountlow');\n        });\n    }\n}\nexports.DataProducer = DataProducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}