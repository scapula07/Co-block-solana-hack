{"ast":null,"code":"var _jsxFileName = \"/Users/user/Desktop/solana-hack-1/client/src/pages/VideoConferencing/videopeer.js\",\n  _s = $RefreshSig$();\nimport { useHuddleStore } from \"@huddle01/huddle01-client/store\";\nimport React, { useCallback, useEffect, useRef } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PeerAudioVideo(_ref) {\n  _s();\n  var _useHuddleStore, _useHuddleStore2;\n  let {\n    peerIdAtIndex\n  } = _ref;\n  const videoRef = useRef(null);\n  const audioRef = useRef(null);\n  const peerCamTrack = (_useHuddleStore = useHuddleStore(useCallback(state => {\n    var _state$peers$peerIdAt, _state$peers$peerIdAt2;\n    return (_state$peers$peerIdAt = state.peers[peerIdAtIndex]) === null || _state$peers$peerIdAt === void 0 ? void 0 : (_state$peers$peerIdAt2 = _state$peers$peerIdAt.consumers) === null || _state$peers$peerIdAt2 === void 0 ? void 0 : _state$peers$peerIdAt2.cam;\n  }, [peerIdAtIndex]))) === null || _useHuddleStore === void 0 ? void 0 : _useHuddleStore.track;\n  const peerMicTrack = (_useHuddleStore2 = useHuddleStore(useCallback(state => {\n    var _state$peers$peerIdAt3, _state$peers$peerIdAt4;\n    return (_state$peers$peerIdAt3 = state.peers[peerIdAtIndex]) === null || _state$peers$peerIdAt3 === void 0 ? void 0 : (_state$peers$peerIdAt4 = _state$peers$peerIdAt3.consumers) === null || _state$peers$peerIdAt4 === void 0 ? void 0 : _state$peers$peerIdAt4.mic;\n  }, [peerIdAtIndex]))) === null || _useHuddleStore2 === void 0 ? void 0 : _useHuddleStore2.track;\n  const getStream = _track => {\n    const stream = new MediaStream();\n    stream.addTrack(_track);\n    return stream;\n  };\n  useEffect(() => {\n    const videoObj = videoRef.current;\n    if (videoObj && peerCamTrack) {\n      videoObj.load();\n      videoObj.srcObject = getStream(peerCamTrack);\n      videoObj.play().catch(err => {\n        console.log({\n          message: \"Error playing video\",\n          meta: {\n            err\n          }\n        });\n      });\n    }\n    return () => {\n      if (videoObj) {\n        videoObj === null || videoObj === void 0 ? void 0 : videoObj.pause();\n        videoObj.srcObject = null;\n      }\n    };\n  }, [peerCamTrack]);\n  useEffect(() => {\n    if (peerMicTrack && audioRef.current) {\n      audioRef.current.srcObject = getStream(peerMicTrack);\n    }\n  }, [peerMicTrack]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      muted: true,\n      autoPlay: true,\n      playsInline: true,\n      className: \"w-full\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      ref: audioRef,\n      autoPlay: true,\n      playsInline: true,\n      controls: false\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n}\n_s(PeerAudioVideo, \"hWhJWu4a0eHRb5UEt25SZu87d10=\", false, function () {\n  return [useHuddleStore, useHuddleStore];\n});\n_c = PeerAudioVideo;\nvar _c;\n$RefreshReg$(_c, \"PeerAudioVideo\");","map":{"version":3,"names":["useHuddleStore","React","useCallback","useEffect","useRef","PeerAudioVideo","peerIdAtIndex","videoRef","audioRef","peerCamTrack","state","peers","consumers","cam","track","peerMicTrack","mic","getStream","_track","stream","MediaStream","addTrack","videoObj","current","load","srcObject","play","catch","err","console","log","message","meta","pause"],"sources":["/Users/user/Desktop/solana-hack-1/client/src/pages/VideoConferencing/videopeer.js"],"sourcesContent":["import { useHuddleStore } from \"@huddle01/huddle01-client/store\";\nimport React, { useCallback, useEffect, useRef } from \"react\";\n\nexport default function PeerAudioVideo({ peerIdAtIndex }) {\n  const videoRef = useRef(null);\n  const audioRef = useRef(null);\n\n  const peerCamTrack = useHuddleStore(\n    useCallback(\n      (state) => state.peers[peerIdAtIndex]?.consumers?.cam,\n      [peerIdAtIndex]\n    )\n  )?.track;\n\n  const peerMicTrack = useHuddleStore(\n    useCallback(\n      (state) => state.peers[peerIdAtIndex]?.consumers?.mic,\n      [peerIdAtIndex]\n    )\n  )?.track;\n\n  const getStream = (_track) => {\n    const stream = new MediaStream();\n    stream.addTrack(_track);\n    return stream;\n  };\n\n  useEffect(() => {\n    const videoObj = videoRef.current;\n\n    if (videoObj && peerCamTrack) {\n      videoObj.load();\n      videoObj.srcObject = getStream(peerCamTrack);\n      videoObj.play().catch((err) => {\n        console.log({\n          message: \"Error playing video\",\n          meta: {\n            err,\n          },\n        });\n      });\n    }\n\n    return () => {\n      if (videoObj) {\n        videoObj?.pause();\n        videoObj.srcObject = null;\n      }\n    };\n  }, [peerCamTrack]);\n\n  useEffect(() => {\n    if (peerMicTrack && audioRef.current) {\n      audioRef.current.srcObject = getStream(peerMicTrack);\n    }\n  }, [peerMicTrack]);\n\n  return (\n    <div className=\"w-full\">\n      <video\n        ref={videoRef}\n        muted\n        autoPlay\n        playsInline\n        className=\"w-full\"\n      />\n      <audio ref={audioRef} autoPlay playsInline controls={false}></audio>\n    </div>\n  )\n}"],"mappings":";;AAAA,SAASA,cAAc,QAAQ,iCAAiC;AAChE,OAAOC,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAAC;AAE9D,eAAe,SAASC,cAAc,OAAoB;EAAA;EAAA;EAAA,IAAnB;IAAEC;EAAc,CAAC;EACtD,MAAMC,QAAQ,GAAGH,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAMI,QAAQ,GAAGJ,MAAM,CAAC,IAAI,CAAC;EAE7B,MAAMK,YAAY,sBAAGT,cAAc,CACjCE,WAAW,CACRQ,KAAK;IAAA;IAAA,gCAAKA,KAAK,CAACC,KAAK,CAACL,aAAa,CAAC,oFAA1B,sBAA4BM,SAAS,2DAArC,uBAAuCC,GAAG;EAAA,GACrD,CAACP,aAAa,CAAC,CAChB,CACF,oDALoB,gBAKlBQ,KAAK;EAER,MAAMC,YAAY,uBAAGf,cAAc,CACjCE,WAAW,CACRQ,KAAK;IAAA;IAAA,iCAAKA,KAAK,CAACC,KAAK,CAACL,aAAa,CAAC,qFAA1B,uBAA4BM,SAAS,2DAArC,uBAAuCI,GAAG;EAAA,GACrD,CAACV,aAAa,CAAC,CAChB,CACF,qDALoB,iBAKlBQ,KAAK;EAER,MAAMG,SAAS,GAAIC,MAAM,IAAK;IAC5B,MAAMC,MAAM,GAAG,IAAIC,WAAW,EAAE;IAChCD,MAAM,CAACE,QAAQ,CAACH,MAAM,CAAC;IACvB,OAAOC,MAAM;EACf,CAAC;EAEDhB,SAAS,CAAC,MAAM;IACd,MAAMmB,QAAQ,GAAGf,QAAQ,CAACgB,OAAO;IAEjC,IAAID,QAAQ,IAAIb,YAAY,EAAE;MAC5Ba,QAAQ,CAACE,IAAI,EAAE;MACfF,QAAQ,CAACG,SAAS,GAAGR,SAAS,CAACR,YAAY,CAAC;MAC5Ca,QAAQ,CAACI,IAAI,EAAE,CAACC,KAAK,CAAEC,GAAG,IAAK;QAC7BC,OAAO,CAACC,GAAG,CAAC;UACVC,OAAO,EAAE,qBAAqB;UAC9BC,IAAI,EAAE;YACJJ;UACF;QACF,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ;IAEA,OAAO,MAAM;MACX,IAAIN,QAAQ,EAAE;QACZA,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEW,KAAK,EAAE;QACjBX,QAAQ,CAACG,SAAS,GAAG,IAAI;MAC3B;IACF,CAAC;EACH,CAAC,EAAE,CAAChB,YAAY,CAAC,CAAC;EAElBN,SAAS,CAAC,MAAM;IACd,IAAIY,YAAY,IAAIP,QAAQ,CAACe,OAAO,EAAE;MACpCf,QAAQ,CAACe,OAAO,CAACE,SAAS,GAAGR,SAAS,CAACF,YAAY,CAAC;IACtD;EACF,CAAC,EAAE,CAACA,YAAY,CAAC,CAAC;EAElB,oBACE;IAAK,SAAS,EAAC,QAAQ;IAAA,wBACrB;MACE,GAAG,EAAER,QAAS;MACd,KAAK;MACL,QAAQ;MACR,WAAW;MACX,SAAS,EAAC;IAAQ;MAAA;MAAA;MAAA;IAAA,QAClB,eACF;MAAO,GAAG,EAAEC,QAAS;MAAC,QAAQ;MAAC,WAAW;MAAC,QAAQ,EAAE;IAAM;MAAA;MAAA;MAAA;IAAA,QAAS;EAAA;IAAA;IAAA;IAAA;EAAA,QAChE;AAEV;AAAC,GAlEuBH,cAAc;EAAA,QAIfL,cAAc,EAOdA,cAAc;AAAA;AAAA,KAXbK,cAAc;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}