{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.associated = exports.findProgramAddressSync = exports.createProgramAddressSync = exports.createWithSeedSync = void 0;\nconst buffer_1 = require(\"buffer\");\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\nconst js_sha256_1 = require(\"js-sha256\");\nconst web3_js_1 = require(\"@solana/web3.js\");\nconst common_js_1 = require(\"../program/common.js\");\n// Sync version of web3.PublicKey.createWithSeed.\nfunction createWithSeedSync(fromPublicKey, seed, programId) {\n  const buffer = buffer_1.Buffer.concat([fromPublicKey.toBuffer(), buffer_1.Buffer.from(seed), programId.toBuffer()]);\n  const hash = js_sha256_1.sha256.digest(buffer);\n  return new web3_js_1.PublicKey(buffer_1.Buffer.from(hash));\n}\nexports.createWithSeedSync = createWithSeedSync;\n// Sync version of web3.PublicKey.createProgramAddress.\nfunction createProgramAddressSync(seeds, programId) {\n  const MAX_SEED_LENGTH = 32;\n  let buffer = buffer_1.Buffer.alloc(0);\n  seeds.forEach(function (seed) {\n    if (seed.length > MAX_SEED_LENGTH) {\n      throw new TypeError(`Max seed length exceeded`);\n    }\n    buffer = buffer_1.Buffer.concat([buffer, toBuffer(seed)]);\n  });\n  buffer = buffer_1.Buffer.concat([buffer, programId.toBuffer(), buffer_1.Buffer.from(\"ProgramDerivedAddress\")]);\n  let hash = (0, js_sha256_1.sha256)(new Uint8Array(buffer));\n  let publicKeyBytes = new bn_js_1.default(hash, 16).toArray(undefined, 32);\n  if (web3_js_1.PublicKey.isOnCurve(new Uint8Array(publicKeyBytes))) {\n    throw new Error(`Invalid seeds, address must fall off the curve`);\n  }\n  return new web3_js_1.PublicKey(publicKeyBytes);\n}\nexports.createProgramAddressSync = createProgramAddressSync;\n// Sync version of web3.PublicKey.findProgramAddress.\nfunction findProgramAddressSync(seeds, programId) {\n  let nonce = 255;\n  let address;\n  while (nonce != 0) {\n    try {\n      const seedsWithNonce = seeds.concat(buffer_1.Buffer.from([nonce]));\n      address = createProgramAddressSync(seedsWithNonce, programId);\n    } catch (err) {\n      if (err instanceof TypeError) {\n        throw err;\n      }\n      nonce--;\n      continue;\n    }\n    return [address, nonce];\n  }\n  throw new Error(`Unable to find a viable program address nonce`);\n}\nexports.findProgramAddressSync = findProgramAddressSync;\nconst toBuffer = arr => {\n  if (arr instanceof buffer_1.Buffer) {\n    return arr;\n  } else if (arr instanceof Uint8Array) {\n    return buffer_1.Buffer.from(arr.buffer, arr.byteOffset, arr.byteLength);\n  } else {\n    return buffer_1.Buffer.from(arr);\n  }\n};\nasync function associated(programId) {\n  let seeds = [buffer_1.Buffer.from([97, 110, 99, 104, 111, 114])]; // b\"anchor\".\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  args.forEach(arg => {\n    seeds.push(arg instanceof buffer_1.Buffer ? arg : (0, common_js_1.translateAddress)(arg).toBuffer());\n  });\n  const [assoc] = await web3_js_1.PublicKey.findProgramAddress(seeds, (0, common_js_1.translateAddress)(programId));\n  return assoc;\n}\nexports.associated = associated;","map":{"version":3,"mappings":";;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA,SAAgBA,kBAAkB,CAChCC,aAAwB,EACxBC,IAAY,EACZC,SAAoB;EAEpB,MAAMC,MAAM,GAAGC,eAAM,CAACC,MAAM,CAAC,CAC3BL,aAAa,CAACM,QAAQ,EAAE,EACxBF,eAAM,CAACG,IAAI,CAACN,IAAI,CAAC,EACjBC,SAAS,CAACI,QAAQ,EAAE,CACrB,CAAC;EACF,MAAME,IAAI,GAAGC,kBAAU,CAACC,MAAM,CAACP,MAAM,CAAC;EACtC,OAAO,IAAIQ,mBAAS,CAACP,eAAM,CAACG,IAAI,CAACC,IAAI,CAAC,CAAC;AACzC;AAZAI;AAcA;AACA,SAAgBC,wBAAwB,CACtCC,KAAiC,EACjCZ,SAAoB;EAEpB,MAAMa,eAAe,GAAG,EAAE;EAE1B,IAAIZ,MAAM,GAAGC,eAAM,CAACY,KAAK,CAAC,CAAC,CAAC;EAC5BF,KAAK,CAACG,OAAO,CAAC,UAAUhB,IAAI;IAC1B,IAAIA,IAAI,CAACiB,MAAM,GAAGH,eAAe,EAAE;MACjC,MAAM,IAAII,SAAS,CAAC,0BAA0B,CAAC;;IAEjDhB,MAAM,GAAGC,eAAM,CAACC,MAAM,CAAC,CAACF,MAAM,EAAEG,QAAQ,CAACL,IAAI,CAAC,CAAC,CAAC;EAClD,CAAC,CAAC;EACFE,MAAM,GAAGC,eAAM,CAACC,MAAM,CAAC,CACrBF,MAAM,EACND,SAAS,CAACI,QAAQ,EAAE,EACpBF,eAAM,CAACG,IAAI,CAAC,uBAAuB,CAAC,CACrC,CAAC;EACF,IAAIC,IAAI,GAAG,sBAAU,EAAC,IAAIY,UAAU,CAACjB,MAAM,CAAC,CAAC;EAC7C,IAAIkB,cAAc,GAAG,IAAIC,eAAE,CAACd,IAAI,EAAE,EAAE,CAAC,CAACe,OAAO,CAACC,SAAS,EAAE,EAAE,CAAC;EAC5D,IAAIb,mBAAS,CAACc,SAAS,CAAC,IAAIL,UAAU,CAACC,cAAc,CAAC,CAAC,EAAE;IACvD,MAAM,IAAIK,KAAK,CAAC,gDAAgD,CAAC;;EAEnE,OAAO,IAAIf,mBAAS,CAACU,cAAc,CAAC;AACtC;AAxBAT;AA0BA;AACA,SAAgBe,sBAAsB,CACpCb,KAAiC,EACjCZ,SAAoB;EAEpB,IAAI0B,KAAK,GAAG,GAAG;EACf,IAAIC,OAA8B;EAClC,OAAOD,KAAK,IAAI,CAAC,EAAE;IACjB,IAAI;MACF,MAAME,cAAc,GAAGhB,KAAK,CAACT,MAAM,CAACD,eAAM,CAACG,IAAI,CAAC,CAACqB,KAAK,CAAC,CAAC,CAAC;MACzDC,OAAO,GAAGhB,wBAAwB,CAACiB,cAAc,EAAE5B,SAAS,CAAC;KAC9D,CAAC,OAAO6B,GAAG,EAAE;MACZ,IAAIA,GAAG,YAAYZ,SAAS,EAAE;QAC5B,MAAMY,GAAG;;MAEXH,KAAK,EAAE;MACP;;IAEF,OAAO,CAACC,OAAO,EAAED,KAAK,CAAC;;EAEzB,MAAM,IAAIF,KAAK,CAAC,+CAA+C,CAAC;AAClE;AApBAd;AAsBA,MAAMN,QAAQ,GAAI0B,GAAwC,IAAY;EACpE,IAAIA,GAAG,YAAY5B,eAAM,EAAE;IACzB,OAAO4B,GAAG;GACX,MAAM,IAAIA,GAAG,YAAYZ,UAAU,EAAE;IACpC,OAAOhB,eAAM,CAACG,IAAI,CAACyB,GAAG,CAAC7B,MAAM,EAAE6B,GAAG,CAACC,UAAU,EAAED,GAAG,CAACE,UAAU,CAAC;GAC/D,MAAM;IACL,OAAO9B,eAAM,CAACG,IAAI,CAACyB,GAAG,CAAC;;AAE3B,CAAC;AAEM,eAAeG,UAAU,CAC9BjC,SAAkB,EACc;EAEhC,IAAIY,KAAK,GAAG,CAACV,eAAM,CAACG,IAAI,CAAC,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAAA,kCAFtD6B,IAA6B;IAA7BA,IAA6B;EAAA;EAGhCA,IAAI,CAACnB,OAAO,CAAEoB,GAAG,IAAI;IACnBvB,KAAK,CAACwB,IAAI,CAACD,GAAG,YAAYjC,eAAM,GAAGiC,GAAG,GAAG,gCAAgB,EAACA,GAAG,CAAC,CAAC/B,QAAQ,EAAE,CAAC;EAC5E,CAAC,CAAC;EACF,MAAM,CAACiC,KAAK,CAAC,GAAG,MAAM5B,mBAAS,CAAC6B,kBAAkB,CAChD1B,KAAK,EACL,gCAAgB,EAACZ,SAAS,CAAC,CAC5B;EACD,OAAOqC,KAAK;AACd;AAbA3B","names":["createWithSeedSync","fromPublicKey","seed","programId","buffer","buffer_1","concat","toBuffer","from","hash","js_sha256_1","digest","web3_js_1","exports","createProgramAddressSync","seeds","MAX_SEED_LENGTH","alloc","forEach","length","TypeError","Uint8Array","publicKeyBytes","bn_js_1","toArray","undefined","isOnCurve","Error","findProgramAddressSync","nonce","address","seedsWithNonce","err","arr","byteOffset","byteLength","associated","args","arg","push","assoc","findProgramAddress"],"sources":["../../../src/utils/pubkey.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}