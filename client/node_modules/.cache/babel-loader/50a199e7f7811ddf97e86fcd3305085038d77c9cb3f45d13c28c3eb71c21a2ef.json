{"ast":null,"code":"export class Connection {\n  constructor(validatedOrigin, targetWindow) {\n    this.validatedOrigin = validatedOrigin;\n    this.targetWindow = targetWindow;\n    this.handlers = new Map();\n  }\n  off(event, callback) {\n    const eventCallbacks = this.handlers.get(event);\n    eventCallbacks === null || eventCallbacks === void 0 ? void 0 : eventCallbacks.delete(callback);\n  }\n  on(event, callback) {\n    var _a;\n    const eventCallbacks = (_a = this.handlers.get(event)) !== null && _a !== void 0 ? _a : new Set();\n    eventCallbacks.add(callback);\n    this.handlers.set(event, eventCallbacks);\n  }\n  send(_ref) {\n    let {\n      event,\n      payload\n    } = _ref;\n    this.targetWindow.postMessage({\n      event,\n      payload\n    }, this.validatedOrigin);\n  }\n  runHandlersForEvent(event, payload) {\n    const eventCallbacks = this.handlers.get(event);\n    if (!eventCallbacks) {\n      return;\n    }\n    for (const callback of eventCallbacks) {\n      callback(payload);\n    }\n  }\n  resetHandlers() {\n    this.handlers.clear();\n  }\n  export() {\n    return {\n      off: this.off.bind(this),\n      on: this.on.bind(this),\n      send: this.send.bind(this),\n      validatedOrigin: this.validatedOrigin\n    };\n  }\n}","map":{"version":3,"mappings":"AASA,OAAM,MAAOA,UAAU;EAGrBC,YACWC,eAAuB,EACvBC,YAAoB;IADpB,oBAAe,GAAfD,eAAe;IACf,iBAAY,GAAZC,YAAY;IAJN,aAAQ,GAAG,IAAIC,GAAG,EAAkC;EAKlE;EAEHC,GAAG,CAACC,KAAiB,EAAEC,QAAuB;IAC5C,MAAMC,cAAc,GAAG,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC;IAC/CE,cAAc,aAAdA,cAAc,uBAAdA,cAAc,CAAEG,MAAM,CAACJ,QAAQ,CAAC;EAClC;EAEAK,EAAE,CAACN,KAAiB,EAAEC,QAAuB;;IAC3C,MAAMC,cAAc,GAAG,UAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC,mCAAI,IAAIO,GAAG,EAAiB;IAC3EL,cAAc,CAACM,GAAG,CAACP,QAAQ,CAAC;IAC5B,IAAI,CAACE,QAAQ,CAACM,GAAG,CAACT,KAAK,EAAEE,cAAc,CAAC;EAC1C;EAEAQ,IAAI,OAA2D;IAAA,IAA1D;MAAEV,KAAK;MAAEW;IAAO,CAA0C;IAC7D,IAAI,CAACd,YAAY,CAACe,WAAW,CAC3B;MACEZ,KAAK;MACLW;KACD,EACD,IAAI,CAACf,eAAe,CACrB;EACH;EAEAiB,mBAAmB,CAACb,KAAiB,EAAEW,OAAgB;IACrD,MAAMT,cAAc,GAAG,IAAI,CAACC,QAAQ,CAACC,GAAG,CAACJ,KAAK,CAAC;IAC/C,IAAI,CAACE,cAAc,EAAE;MACnB;;IAEF,KAAK,MAAMD,QAAQ,IAAIC,cAAc,EAAE;MACrCD,QAAQ,CAACU,OAAO,CAAC;;EAErB;EAEAG,aAAa;IACX,IAAI,CAACX,QAAQ,CAACY,KAAK,EAAE;EACvB;EAEAC,MAAM;IACJ,OAAO;MACLjB,GAAG,EAAE,IAAI,CAACA,GAAG,CAACkB,IAAI,CAAC,IAAI,CAAC;MACxBX,EAAE,EAAE,IAAI,CAACA,EAAE,CAACW,IAAI,CAAC,IAAI,CAAC;MACtBP,IAAI,EAAE,IAAI,CAACA,IAAI,CAACO,IAAI,CAAC,IAAI,CAAC;MAC1BrB,eAAe,EAAE,IAAI,CAACA;KACvB;EACH","names":["Connection","constructor","validatedOrigin","targetWindow","Map","off","event","callback","eventCallbacks","handlers","get","delete","on","Set","add","set","send","payload","postMessage","runHandlersForEvent","resetHandlers","clear","export","bind"],"sources":["../../../src/core/connection.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}